<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="Project page of MaskGWM">
  <meta name="keywords" content="Driving world model">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><b>MaskGWM</b>: Generalizable Driving World Model with Video Mask Reconstruction <br></title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./data/static/css/bulma.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-carousel@4.0.3/dist/css/bulma-carousel.min.css">
  <!-- <link rel="stylesheet" href="./data/static/css/fontawesome.all.min.css"> -->
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" /> -->
  <link rel="stylesheet" href="./data/static/css/index.css">

  <link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

  <script src="./data/static/js/jquery-3.2.1.min.js"></script>
  <script defer="" src="./data/static/js/fontawesome.all.min.js"></script>
  <script src="./data/static/js/jquery.event.move.js"></script>

  <!-- <link rel="stylesheet" href="./data/static/css/index.css"> -->
  <!-- <link rel="icon" href="./images/"> -->

  <script src="https://cdn.jsdelivr.net/npm/bulma-carousel@4.0.3/dist/js/bulma-carousel.min.js"></script>

  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <!-- <script>
    $(document).ready(function () {
      var int = setInterval(fixCount, 100);
      var busuanziSiteOffset = parseInt(0);
      function fixCount() {
        if ($("#busuanzi_container_page_pv").css("display") != "none") {
          clearInterval(int);
          $("#busuanzi_value_page_pv").html(
            parseInt($("#busuanzi_value_page_pv").html()) + busuanziSiteOffset
          );
        }
      }
    });
  </script> -->
  <style>
    @media(max-width: 500px) {
      .reverse-columns {
        flex-direction: column-reverse;
        display: flex;
      }
    }

    .titled {
      font-family: 'Merriweather', serif !important;
      font-size: 58px !important;
      font-weight: 400 !important;
      line-height: 64px !important;
    }

    .subtitled {
      font-family: 'Merriweather', serif !important;
      font-size: 22px !important;
      font-weight: 400 !important;
      line-height: 36px !important;
    }
  </style>
  <style type="text/css">
    [mt_node=trans_loading]::after {
      content: '';
      vertical-align: middle !important;
      width: 1em !important;
      height: 1em !important;
      display: inline-block !important;
      margin: 0 4px !important;
      border: 2px rgba(0, 0, 0, 0.25) solid !important;
      border-top: 2px rgba(0, 0, 0, 1) solid !important;
      border-radius: 50% !important;
      padding: 0 !important;
      -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
      animation: immersive-translate-loading-animation 0.6s infinite linear !important;
    }

    @keyframes immersive-translate-loading-animation {
      from {
        transform: rotate(0deg, 0deg, 0deg);
      }

      to {
        transform: rotate(359deg, 0deg, 0deg);
      }
    }
  </style>
  <style type="text/css">
    [mt_node^=trans] {
      display: none !important;
    }
  </style>

</head>

<body>
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">

            <h1 class="title is-1 publication-title">
              <b>MaskGWM</b>: Generalizable Driving World Model with Video Mask Reconstruction <br>
            </h1>
            <div class="is-size-4 publication-authors">
              <span style="color: blue;" class="author-block">Jingcheng Ni,</span>
              <span style="color: blue;" class="author-block">Yuxin Guo,</span>
              <span style="color: blue;" class="author-block">Yichen Liu,</span>
              <span style="color: blue;" class="author-block">Rui Chen,</span>
              <span style="color: blue;" class="author-block">Lewei Lu,</span>
              <span style="color: blue;" class="author-block">Zehuan Wu,</span>
            </div>

            <div class="is-size-4 publication-authors">
              <span class="author-block">SenseTime Research</span>
            </div>

            <div class="column has-text-centered">

              <div class="publication-links">
                <!-- PDF Link. -->
                <!-- <span class="link-block">
                  <a href="https://" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span> -->
                <!-- Arxiv Link. -->
                <span class="link-block">
                  <a href="https://" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <!-- Code Link. -->
                <span class="link-block">
                  <a href="https://" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered" style="background-color: #f5f5f5;">
        <div class="column is-five-sixths">
          <!-- <h2 style="font-family: 'Comic Sans MS', cursive; margin: 0; text-align: left" class="title is-3">Abstract</h2> -->
          <h2 style="font-family: 'Comic Sans MS'; text-align: left; padding: 30px 50px 20px 50px" class="title is-3">
            Abstract</h2>
          <div class="content has-text-justified"
            style="font-family: 'Times New Roman'; padding: 0px 50px 20px 50px; font-size: 20px;">
            <p>
              World models that forecast environmental changes from actions are vital for autonomous driving models with
              strong generalization.
              The prevailing driving world model mainly build on pixel-level video prediction model. Although these
              models can produce high-fidelity video sequences with advanced diffusion-based generator, they are
              constrained by their predictive duration and overall generalization capabilities. In this paper, we
              explore to solve this problem by combining pixel-level generation loss with MAE-style feature-level
              context learning. In particular, we instantiate this target with three key design: (1) A more scalable
              Diffusion Transformer (DiT) structure trained with extra mask construction task. (2) we devise
              diffusion-related mask tokens to deal with the fuzzy relations between mask reconstruction and generative
              diffusion process. (3) we extend mask construction task to spatial-temporal domain by utilizing row-wise
              mask for shifted self-attention rather than masked self-attention in MAE. Then, we adopt a row-wise
              cross-view module to align with this mask design.
              Based on above improvement, we propose MaskGWM: a Generalizable driving World
              Model embodied with Video Mask reconstruction.
              Our model contains two variants: MaskGWM-long, focusing on long-horizon prediction, and MaskGWM-mview,
              dedicated to multi-view generation.
              Comprehensive experiments on standard benchmarks validate the effectiveness of the proposed method, which
              contain normal validation of Nuscene dataset, long-horizon rollout of OpenDV-2K dataset and zero-shot
              validation of Waymo dataset. Quantitative metrics on these datasets show our method notably improving
              state-of-the-art driving world model.
            </p>
          </div>
        </div>
      </div>
      <!--/ Abstract. -->

    </div>
  </section>

  <section class="hero is-light is-small">
    <div class="hero-body">
      <div class="container">

        <h2 class="title is-3" style="font-family: 'Comic Sans MS'; text-align: left; padding: 10px 50px 20px 50px">
          Overview: Extend Mask Reconstruction to Spatial-temporal DiT</h2>
        <div class="columns is-centered has-text-centered">
          <img src="./data/img/framework.png" alt="architecture of MaskGWM" width="90%">
        </div>
        <p class="content has-text-left is-size-5">
          We propose mask reconstruction containing token mask and token reconstruction as a complementary task for training dring world model.
        </p>
      </div>
    </div>
  </section>

  <section class="hero is-small", style="height: 650px;">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Generate 15s with 7 Auto-regressive Steps</h2>
        <div id="results-1" class="carousel results-carousel">
          <div class="item">
            <!-- <p class="content has-text-centered is-size-5">
              <i>"daytime, sunny"</i>
            </p> -->
            <video playsinline controls preload="none" muted loop width="100%">
              <source data-src="./data/video/sw_15s/vid_1.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item">
            <!-- <p class="content has-text-centered is-size-5">
              <i>"daytime, rainy"</i>
            </p> -->
            <video playsinline controls preload="none" muted loop width="100%">
              <source data-src="./data/video/sw_15s/vid_2.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item">
            <video playsinline controls preload="none" muted loop width="100%">
              <source data-src="./data/video/sw_15s/vid_3.mp4" type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>
    </div>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const carouselElement = document.querySelector('#results-1');
      const items = carouselElement.querySelectorAll('.item');

      // add poster
      const videos = carouselElement.querySelectorAll('video');
      videos.forEach(video => {
        const source = video.querySelector('source');
        const videoSrc = source.dataset.src || source.src;
      });

      // Initialize the carousel with autoplay
      const carousel = bulmaCarousel.attach('#results-1', {
        slidesToScroll: 1,
        slidesToShow: 1,
        loop: true,
        infinite: false,
        autoplay: false,
        breakpoints: [],
      })[0];

      // Function to load video source
      function loadVideo(videoElement) {
        const source = videoElement.querySelector('source');
        if (source.dataset.src && !source.src) {
          source.src = source.dataset.src;
          videoElement.load();
        }
      }

      // Function to handle video play/pause
      function handleVideos(bulmaCarouselInstance) {
        if (bulmaCarouselInstance && bulmaCarouselInstance.next) {
          currentIndex = bulmaCarouselInstance.next
        } else {
          currentIndex = 0
        }
        items.forEach((item, index) => {
          const videos = item.querySelectorAll('video');
          videos.forEach(video => {
            if (index === currentIndex) {
              loadVideo(video);
              video.currentTime = 0; // Reset to start
              video.play();
            } else {
              video.pause();
            }
          });
        });
      }

      // Listen for carousel slide changes
      carousel.on('after:show', function (bulmaCarouselInstance) {
        handleVideos(bulmaCarouselInstance);
      });

      // Initial load
      handleVideos();
    });
  </script>

  <section class="hero is-small", style="height: 650px;">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Generate 12s Multi-view Videos with Layout Control</h2>
        <div id="results-2" class="carousel results-carousel">
          <div class="item">
            <video playsinline controls preload="none" muted loop width="100%">
              <source data-src="./data/video/mv_12s/merge_mview_1_cp.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item">
            <video playsinline controls preload="none" muted loop width="100%">
              <source data-src="./data/video/mv_12s/merge_mview_0_cp.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item">
            <video playsinline controls preload="none" muted loop width="100%">
              <source data-src="./data/video/mv_12s/merge_mview_2_cp.mp4" type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>
    </div>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const carouselElement = document.querySelector('#results-2');
      const items = carouselElement.querySelectorAll('.item');

      // add poster
      const videos = carouselElement.querySelectorAll('video');
      videos.forEach(video => {
        const source = video.querySelector('source');
        const videoSrc = source.dataset.src || source.src;
      });

      // Initialize the carousel with autoplay
      const carousel = bulmaCarousel.attach('#results-2', {
        slidesToScroll: 1,
        slidesToShow: 1,
        loop: true,
        infinite: false,
        autoplay: false,
        breakpoints: [],
      })[0];

      // Function to load video source
      function loadVideo(videoElement) {
        const source = videoElement.querySelector('source');
        if (source.dataset.src && !source.src) {
          source.src = source.dataset.src;
          videoElement.load();
        }
      }

      // Function to handle video play/pause
      function handleVideos(bulmaCarouselInstance) {
        if (bulmaCarouselInstance && bulmaCarouselInstance.next) {
          currentIndex = bulmaCarouselInstance.next
        } else {
          currentIndex = 0
        }
        items.forEach((item, index) => {
          const videos = item.querySelectorAll('video');
          videos.forEach(video => {
            if (index === currentIndex) {
              loadVideo(video);
              video.currentTime = 0; // Reset to start
              video.play();
            } else {
              video.pause();
            }
          });
        });
      }

      // Listen for carousel slide changes
      carousel.on('after:show', function (bulmaCarouselInstance) {
        handleVideos(bulmaCarouselInstance);
      });

      // Initial load
      handleVideos();
    });
  </script>

  <section class="hero is-small", style="height: 650px;">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Comparisons with Vista        </h2>
        <div id="results-3" class="carousel results-carousel">
          <div class="item">
            <!-- <p class="content has-text-centered is-size-5">
              <i>"sunny" -> "snowy"</i>
            </p> -->
            <video playsinline controls preload="none" muted loop width="100%">
              <source data-src="./data/video/sw_15s/vid_cmp.mp4" type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>
    </div>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const carouselElement = document.querySelector('#results-3');
      const items = carouselElement.querySelectorAll('.item');

      // add poster
      const videos = carouselElement.querySelectorAll('video');
      videos.forEach(video => {
        const source = video.querySelector('source');
        const videoSrc = source.dataset.src || source.src;
      });

      // Initialize the carousel with autoplay
      const carousel = bulmaCarousel.attach('#results-3', {
        slidesToScroll: 1,
        slidesToShow: 1,
        loop: true,
        infinite: false,
        autoplay: false,
        breakpoints: [],
      })[0];

      // Function to load video source
      function loadVideo(videoElement) {
        const source = videoElement.querySelector('source');
        if (source.dataset.src && !source.src) {
          source.src = source.dataset.src;
          videoElement.load();
        }
      }

      // Function to handle video play/pause
      function handleVideos(bulmaCarouselInstance) {
        if (bulmaCarouselInstance && bulmaCarouselInstance.next) {
          currentIndex = bulmaCarouselInstance.next
        } else {
          currentIndex = 0
        }
        items.forEach((item, index) => {
          const videos = item.querySelectorAll('video');
          videos.forEach(video => {
            if (index === currentIndex) {
              loadVideo(video);
              video.currentTime = 0; // Reset to start
              video.play();
            } else {
              video.pause();
            }
          });
        });
      }

      // Listen for carousel slide changes
      carousel.on('after:show', function (bulmaCarouselInstance) {
        handleVideos(bulmaCarouselInstance);
      });

      // Initial load
      handleVideos();
    });
  </script>


  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="content">
          <h2 class="title is-3 has-text-centered">Please check our paper for more details and results!
          </h2>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="columns is-centered">
          <p class="text-justify">
          The website template is borrowed from <a href="https://gaoruiyuan.com/magicdrivedit/">MagicDriveDiT</a>
          </p>
      </div>
    </div>
  </footer>

</body>

</html>